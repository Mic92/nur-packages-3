From 698c120d7a3589c2ef56f945a63836523f52f7f8 Mon Sep 17 00:00:00 2001
From: Will Dietz <w@wdtz.org>
Date: Sun, 11 Dec 2016 11:28:22 -0600
Subject: [PATCH 2/5] attempt to work around Meta.hs error?

---
 MD/Syntax/Meta.hs | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

diff --git a/MD/Syntax/Meta.hs b/MD/Syntax/Meta.hs
index 9e01895..266a698 100644
--- a/MD/Syntax/Meta.hs
+++ b/MD/Syntax/Meta.hs
@@ -1,4 +1,4 @@
-{-# LANGUAGE TemplateHaskell #-}
+{-# LANGUAGE TemplateHaskell, FlexibleInstances #-}
 {-# OPTIONS -fno-warn-missing-signatures #-}
 {-|
   Description : Meta-data for enumerations.
@@ -27,13 +27,13 @@ metaDecl name =
        ; ~(TyConI (DataD [] _ [] cs [])) <- reify name
        ; t <- [t| [($(conT name), String)] |]
        ; e <- listE (map mapr cs)
-       ; d <- [d| show x = case lookup x $(varE n) of
-                             Just y  -> y
-                             Nothing -> error "meta" |]
+       ; d <- [d|instance Show $(conT name) where show x = case lookup x $(varE n) of
+                                                                 Just y  -> y
+                                                                 Nothing -> error "meta" |]
        ; return
          [ SigD n t
          , ValD (VarP n) (NormalB e) []
-         , InstanceD [] (AppT (ConT $ mkName "Show") (ConT name)) d
+         , (head d)
          ]
        }
 
-- 
2.10.0

